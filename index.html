<aside class="w-72 bg-zinc-900 flex flex-col border-r border-zinc-800">
        <div class="p-6 font-black text-indigo-500 border-b border-zinc-800 flex justify-between items-center">
            <span>PRO PANEL <span id="admin-badge" class="hidden text-[8px] bg-indigo-600 text-white px-2 py-0.5 rounded ml-2">ADMIN</span></span>
            <button onclick="logout()" class="text-[10px] text-zinc-500 hover:text-red-500">Ã‡IKIÅž</button>
        </div>
        <div id="channel-list" class="flex-1 p-3 space-y-1 overflow-y-auto"></div>
        
        <div id="admin-controls" class="p-4 bg-zinc-950/40 border-t border-zinc-800">
            <input id="new-ch" class="w-full p-3 bg-zinc-800 rounded-xl text-xs mb-2 outline-none border border-zinc-700 focus:border-indigo-500" placeholder="Yeni Kanal AdÄ±...">
            <button onclick="createChannel()" class="w-full bg-indigo-600 py-2 rounded-xl text-[10px] font-bold uppercase">KANAL OLUÅžTUR</button>
        </div>
    </aside>

    <script>
        // Mevcut WebRTC kodlarÄ± korunuyor, sadece Admin mantÄ±ÄŸÄ± eklendi
        let _supabase, user, activeCh, pc, localStream, channel;
        const config = { iceServers: [{ urls: 'stun:stun.l.google.com:19302' }] };

        window.onload = () => {
            _supabase = supabase.createClient("https://zdixrufuczabxhvsvwsd.supabase.co", "sb_publishable_cQH31e8TGNu-KuWRIr6_xA_r5yA1eV8");
            checkUser();
        };

        async function checkUser() {
            const { data: { session } } = await _supabase.auth.getSession();
            if (session) { 
                user = session.user; 
                document.getElementById('auth-screen').classList.add('hidden'); 
                loadChannels(); 
            }
        }

        async function loadChannels() {
            const { data } = await _supabase.from('channels').select('*');
            const list = document.getElementById('channel-list'); list.innerHTML = '';
            
            data?.forEach(ch => {
                const isAdmin = ch.creator_id === user.id;
                const div = document.createElement('div');
                div.className = "group flex items-center justify-between p-1";
                
                div.innerHTML = `
                    <button onclick="selectChannel('${ch.id}', '${ch.name}', '${ch.creator_id}')" class="flex-1 text-left p-2 rounded-xl hover:bg-zinc-800 text-xs font-bold uppercase transition-all">
                        # ${ch.name} ${isAdmin ? 'ðŸ‘‘' : ''}
                    </button>
                    ${isAdmin ? `<button onclick="deleteChannel('${ch.id}')" class="hidden group-hover:block text-red-500 text-xs px-2">X</button>` : ''}
                `;
                list.appendChild(div);
            });
        }

        async function selectChannel(id, name, creatorId) {
            activeCh = id;
            document.getElementById('ch-title').innerText = "# " + name;
            document.getElementById('call-btn').classList.remove('hidden');
            document.getElementById('chat-form').classList.remove('hidden');
            
            // Admin Rozeti KontrolÃ¼
            const badge = document.getElementById('admin-badge');
            if(creatorId === user.id) badge.classList.remove('hidden'); else badge.classList.add('hidden');

            loadMessages(); setupRealtime();
        }

        async function deleteChannel(id) {
            if(!confirm("KanalÄ± silmek istediÄŸine emin misin?")) return;
            const { error } = await _supabase.from('channels').delete().eq('id', id);
            if(error) alert("Sadece kanal sahibi silebilir!"); else loadChannels();
        }

        async function createChannel() {
            const name = document.getElementById('new-ch').value;
            if(!name) return;
            await _supabase.from('channels').insert([{ name, creator_id: user.id }]);
            document.getElementById('new-ch').value = ''; 
            loadChannels();
        }

        // ... (DiÄŸer WebRTC, MesajlaÅŸma ve Logout fonksiyonlarÄ± aynÄ± ÅŸekilde devam ediyor)
        async function logout() { await _supabase.auth.signOut(); location.reload(); }
        async function handleAuth(type) {
            const email = document.getElementById('auth-email').value, password = document.getElementById('auth-password').value;
            const { error } = type === 'login' ? await _supabase.auth.signInWithPassword({email, password}) : await _supabase.auth.signUp({email, password});
            if (error) alert(error.message); else checkUser();
        }
    </script>
